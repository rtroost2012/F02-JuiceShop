(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{s2oO:function(e,t,r){"use strict";r.r(t);var n=r("mrSG"),o={"":["<em>","</em>"],_:["<strong>","</strong>"],"\n":["<br />"]," ":["<br />"],"-":["<hr />"]};function a(e){return e.replace(RegExp("^"+(e.match(/^(\t| )+/)||"")[0],"gm"),"")}function i(e){return(e+"").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var s=function e(t){var r,n,s,u,c,l=/((?:^|\n+)(?:\n---+|\* \*(?: \*)+)\n)|(?:^```(\w*)\n([\s\S]*?)\n```$)|((?:(?:^|\n+)(?:\t|  {2,}).+)+\n*)|((?:(?:^|\n)([>*+-]|\d+\.)\s+.*)+)|(?:\!\[([^\]]*?)\]\(([^\)]+?)\))|(\[)|(\](?:\(([^\)]+?)\))?)|(?:(?:^|\n+)([^\s].*)\n(\-{3,}|={3,})(?:\n+|$))|(?:(?:^|\n+)(#{1,3})\s*(.+)(?:\n+|$))|(?:`([^`].*?)`)|(  \n\n*|\n{2,}|__|\*\*|[_*])/gm,p=[],d="",h=0,f={};function m(e){var t=o[e.replace(/\*/g,"_")[1]||""],r=p[p.length-1]==e;return t?t[1]?(p[r?"pop":"push"](e),t[0|r]):t[0]:e}function x(){for(var e="";p.length;)e+=m(p[p.length-1]);return e}for(t=t.replace(/^\[(.+?)\]:\s*(.+)$/gm,(function(e,t,r){return f[t.toLowerCase()]=r,""})).replace(/^\n+|\n+$/g,"");s=l.exec(t);)n=t.substring(h,s.index),h=l.lastIndex,r=s[0],n.match(/[^\\](\\\\)*\\$/)||(s[3]||s[4]?r='<pre class="code '+(s[4]?"poetry":s[2].toLowerCase())+'">'+a(i(s[3]||s[4]).replace(/^\n+|\n+$/g,""))+"</pre>":s[6]?((c=s[6]).match(/\./)&&(s[5]=s[5].replace(/^\d+/gm,"")),u=e(a(s[5].replace(/^\s*[>*+.-]/gm,""))),">"===c?c="blockquote":(c=c.match(/\./)?"ol":"ul",u=u.replace(/^(.*)(\n|$)/gm,"<li>$1</li>")),r="<"+c+">"+u+"</"+c+">"):s[8]?r='<img src="'+i(s[8])+'" alt="'+i(s[7])+'">':s[10]?(d=d.replace("<a>",'<a href="'+i(s[11]||f[n.toLowerCase()])+'">'),r=x()+"</a>"):s[9]?r="<a>":s[12]||s[14]?r="<"+(c="h"+(s[14]?s[14].length:"="===s[13][0]?1:2))+">"+e(s[12]||s[15])+"</"+c+">":s[16]?r="<code>"+i(s[16])+"</code>":(s[17]||s[1])&&(r=m(s[17]||"--"))),d+=n,d+=r;return(d+t.substring(h)+x()).trim()};function u(e){return new Promise((function(t){setTimeout(t,e)}))}function c(e,t){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{ignoreCase:!0};return function(){return Object(n.a)(r,void 0,void 0,regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=document.querySelector(e);case 1:if(n.value===t||o.ignoreCase&&n.value.toLowerCase()===t.toLowerCase()){r.next=6;break}return r.next=4,u(100);case 4:r.next=1;break;case 6:case"end":return r.stop()}}),r)})))}}function l(e){var t=this;return function(){return Object(n.a)(t,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(r=document.querySelector(e))||console.warn('Could not find Element with selector "'.concat(e,'"')),t.next=4,new Promise((function(e){r.addEventListener("click",(function(){return e()}))}));case 4:case"end":return t.stop()}}),t)})))}}function p(e,t){var r=this;return function(){return Object(n.a)(r,void 0,void 0,regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(n=document.querySelector(e))||n.innerHTML!==t){r.next=3;break}return r.abrupt("break",7);case 3:return r.next=5,u(100);case 5:r.next=0;break;case 7:case"end":return r.stop()}}),r)})))}}function d(e){return function(){return u(e)}}function h(e){var t=this;return function(){return Object(n.a)(t,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(window.location.hash==="#/".concat(e)){t.next=5;break}return t.next=3,u(100);case 3:t.next=0;break;case 5:case"end":return t.stop()}}),t)})))}}var f={name:"Login Admin",hints:[{text:"To start this challenge, you'll have to log out first.",fixture:"#navbarAccount",unskippable:!0,resolved:function(){return Object(n.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===localStorage.getItem("token")){e.next=5;break}return e.next=3,u(100);case 3:e.next=0;break;case 5:case"end":return e.stop()}}),e)})))}},{text:"Let's try if we find a way to log in with the administrator's user account. To begin, go to the _Login_ page via the _Account_ menu.",fixture:"app-navbar",unskippable:!0,resolved:h("login")},{text:"To find a way around the normal login process we will try to use a **SQL Injection** (SQLi) attack.",fixture:"#email",resolved:d(8e3)},{text:"A good starting point for simple SQL Injections is to insert quotation marks (like `\"` or `'`). These mess with the syntax of an insecurely concatenated query and might give you feedback if an endpoint is vulnerable or not.",fixture:"#email",resolved:d(15e3)},{text:"Start with entering `'` in the **email field**.",fixture:"#email",unskippable:!0,resolved:c("#email","'")},{text:"Now put anything in the **password field**. It doesn't matter what.",fixture:"#password",unskippable:!0,resolved:function(e){var t=this;return function(){return Object(n.a)(t,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=document.querySelector("#password");case 1:if(t.value&&""!==t.value){e.next=6;break}return e.next=4,u(100);case 4:e.next=1;break;case 6:case"end":return e.stop()}}),e)})))}}()},{text:"Press the _Log in_ button.",fixture:"#rememberMe",unskippable:!0,resolved:l("#loginButton")},{text:"Nice! Do you see the red `[object Object]` error at the top? Unfortunately it isn't really telling us much about what went wrong...",fixture:"#rememberMe",resolved:d(1e4)},{text:"Maybe you will be able to find out more information about the error in the JavaScript console or the network tab of your browser!",fixture:"#rememberMe",resolved:d(1e4)},{text:"Did you spot the error message with the `SQLITE_ERROR` and the entire SQL query in the console output? If not, keep the console open and click _Log in_ again. Then inspect the occuring log message closely.",fixture:"#rememberMe",resolved:d(3e4)},{text:"Let's try to manipulate the query a bit to make it useful. Try out typing `' OR true` into the **email field**.",fixture:"#email",unskippable:!0,resolved:c("#email","' OR true")},{text:"Now click the _Log in_ button again.",fixture:"#rememberMe",unskippable:!0,resolved:l("#loginButton")},{text:"Mhh... The query is still invalid? Can you see why from the new error in the console?",fixture:"#rememberMe",resolved:d(8e3)},{text:"We need to make sure that the rest of the query after our injection doesn't get executed. Any Ideas?",fixture:"#rememberMe",resolved:d(8e3)},{text:"You can comment out anything after your injection payload from query using comments in SQL. In SQLite databases you can use `--` for that.",fixture:"#rememberMe",resolved:d(1e4)},{text:"So, type in `' OR true--` into the email field.",fixture:"#email",unskippable:!0,resolved:c("#email","' OR true--")},{text:"Press the _Log in_ button again and sit back...",fixture:"#rememberMe",unskippable:!0,resolved:l("#loginButton")},{text:"That worked, right?! To see with whose account you just logged in, open the _Account_ menu.",fixture:"#navbarAccount",unskippable:!0,resolved:l("#navbarAccount")},{text:"\ud83c\udf89 Congratulations! You have been logged in as the **administrator** of the shop! (If you want to understand why, try to reproduce what your `' OR true--` did _exactly_ to the query.)",fixture:"app-navbar",resolved:d(2e4)}]},m={name:"DOM XSS",hints:[{text:"For this challenge, we'll take a close look at the _Search_ field at the top of the screen.",fixture:"#searchQuery",unskippable:!0,resolved:d(8e3)},{text:"Let's start by searching for all products containing `owasp` in their name or description.",fixture:"#searchQuery",unskippable:!0,resolved:c("#searchQuery input","owasp")},{text:"Now hit enter.",fixture:"#searchQuery",unskippable:!0,resolved:p("#searchValue","owasp")},{text:"Nice! You should now see many cool OWASP-related products.",fixture:"#searchQuery",resolved:d(8e3)},{text:"You might have noticed, that your search term is displayed above the results?",fixture:"app-search-result",resolved:d(8e3)},{text:"What we will try now is a **Cross-Site Scripting (XSS)** attack, where we try to inject HTML or JavaScript code into the application.",fixture:"app-search-result",resolved:d(15e3)},{text:"Change your search value into `<h1>owasp` to see if we can inject HTML.",fixture:"#searchQuery",unskippable:!0,resolved:c("#searchQuery input","<h1>owasp")},{text:"Hit enter again.",fixture:"#searchQuery",unskippable:!0,resolved:p("#searchValue","<h1>owasp</h1>")},{text:"Hmm, this doesn't look normal, does it?",fixture:".noResult",resolved:d(8e3)},{text:"If you right-click on the search term and inspect that part of the page with your browser, you will see that our `h1`-tag was _actually_ embedded into the page and is not just shown as plain text!",fixture:".noResult",resolved:d(16e3)},{text:"Let's now try to inject JavaScript. Type `<script>alert(xss)<\/script>` into the search box now.",fixture:"#searchQuery",unskippable:!0,resolved:c("#searchQuery input","<script>alert(xss)<\/script>")},{text:"Hit enter again.",fixture:"#searchQuery",unskippable:!0,resolved:p("#searchValue","<script>alert(xss)<\/script>")},{text:"\ud83d\ude14 This didn't work as we hoped. If you inspect the page, you should see the `script`-tag but it is not executed for some reason.",fixture:".noResult",resolved:d(1e4)},{text:'Luckily there are _many_ different XSS payloads we can try. Let\'s try this one next: <code>&lt;iframe src="javascript:alert(&#96;xss&#96;)"&gt;&lt;/iframe&gt;</code>.',fixture:"#searchQuery",unskippable:!0,resolved:c("#searchQuery input",'<iframe src="javascript:alert(`xss`)">')},{text:"Hit enter one more time. If an alert box appears, you must confirm it in order to close it.",fixture:"#searchQuery",unskippable:!0,resolved:p("#searchValue",'<iframe src="javascript:alert(`xss`)"></iframe>')},{text:"\ud83c\udf89 Congratulations! You just successfully performed an XSS attack!",fixture:".noResult",resolved:d(8e3)},{text:"More precisely, this was a **DOM XSS** attack, because your payload was handled and improperly embedded into the page by the application frontend code without even sending it to the server.",fixture:".noResult",resolved:d(16e3)}]},x={name:"Score Board",hints:[{text:"This application is riddled with security vulnerabilities. Your progress exploiting these is tracked on a _Score Board_.",fixture:"app-navbar",unskippable:!0,resolved:d(1e4)},{text:"You won't find a link to it in the navigation or side bar, though. Finding the _Score Board_ is in itself actually one of the hacking challenges.",fixture:"app-navbar",resolved:d(12e3)},{text:"You could just start guessing the URL of the _Score Board_ or comb through the client-side JavaScript code for useful information.",fixture:"app-navbar",resolved:d(12e3)},{text:"You find the JavaScript code in the DevTools of your browser that will open with `F12`. Or you just start URL guessing. It's up to you!",fixture:"app-navbar",unskippable:!0,resolved:h("score-board")},{text:"\ud83c\udf89 Congratulations! You found the _Score Board_! Good luck and happy hacking!",fixture:"app-score-board",resolved:d(6e4)}]};r.d(t,"hasInstructions",(function(){return b})),r.d(t,"startHackingInstructorFor",(function(){return w}));var v=[x,f,m];function g(e){var t=document.querySelector(e.fixture);if(!t)return null;var r=document.createElement("div");r.id="hacking-instructor",r.style.position="absolute",r.style.zIndex="20000",r.style.backgroundColor="rgba(50, 115, 220, 0.9)",r.style.maxWidth="400px",r.style.minWidth=e.text.length>100?"350px":"250px",r.style.padding="16px",r.style.borderRadius="8px",r.style.whiteSpace="initial",r.style.lineHeight="1.3",r.style.top="24px",!0!==e.unskippable&&(r.style.cursor="pointer"),r.style.fontSize="14px",r.style.display="flex",r.style.alignItems="center";var n=document.createElement("img");n.style.minWidth="64px",n.style.minHeight="64px",n.style.width="64px",n.style.height="64px",n.style.marginRight="8px",n.src="/assets/public/images/hackingInstructor.png";var o=document.createElement("span");o.style.flexGrow="2",o.innerHTML=s(e.text),r.appendChild(n),r.appendChild(o);var a=document.createElement("div");return a.style.position="relative",a.style.display="inline",a.appendChild(r),t.parentElement.insertBefore(a,t),a}function y(e){return new Promise((function(t){e.addEventListener("click",t)}))}function b(e){return void 0!==v.find((function(t){return t.name===e}))}function w(e){return Object(n.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,n,o,a,i,s,u,c,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=v.find((function(t){return t.name===e})),n=!0,o=!1,a=void 0,t.prev=4,i=r.hints[Symbol.iterator]();case 6:if(n=(s=i.next()).done){t.next=21;break}if(u=s.value,c=g(u)){t.next=12;break}return console.warn('Could not find Element with fixture "'.concat(u.fixture,'"')),t.abrupt("continue",18);case 12:return c.scrollIntoView(),l=[u.resolved()],!0!==u.unskippable&&l.push(y(c)),t.next=17,Promise.race(l);case 17:c.remove();case 18:n=!0,t.next=6;break;case 21:t.next=27;break;case 23:t.prev=23,t.t0=t.catch(4),o=!0,a=t.t0;case 27:t.prev=27,t.prev=28,n||null==i.return||i.return();case 30:if(t.prev=30,!o){t.next=33;break}throw a;case 33:return t.finish(30);case 34:return t.finish(27);case 35:case"end":return t.stop()}}),t,null,[[4,23,27,35],[28,,30,34]])})))}}}]);