(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{s2oO:function(e,t,r){"use strict";r.r(t);var o=r("mrSG"),n={"":["<em>","</em>"],_:["<strong>","</strong>"],"\n":["<br />"]," ":["<br />"],"-":["<hr />"]};function i(e){return e.replace(RegExp("^"+(e.match(/^(\t| )+/)||"")[0],"gm"),"")}function a(e){return(e+"").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var s=function e(t){var r,o,s,u,l,c=/((?:^|\n+)(?:\n---+|\* \*(?: \*)+)\n)|(?:^```(\w*)\n([\s\S]*?)\n```$)|((?:(?:^|\n+)(?:\t|  {2,}).+)+\n*)|((?:(?:^|\n)([>*+-]|\d+\.)\s+.*)+)|(?:\!\[([^\]]*?)\]\(([^\)]+?)\))|(\[)|(\](?:\(([^\)]+?)\))?)|(?:(?:^|\n+)([^\s].*)\n(\-{3,}|={3,})(?:\n+|$))|(?:(?:^|\n+)(#{1,3})\s*(.+)(?:\n+|$))|(?:`([^`].*?)`)|(  \n\n*|\n{2,}|__|\*\*|[_*])/gm,d=[],p="",h=0,f={};function m(e){var t=n[e.replace(/\*/g,"_")[1]||""],r=d[d.length-1]==e;return t?t[1]?(d[r?"pop":"push"](e),t[0|r]):t[0]:e}function y(){for(var e="";d.length;)e+=m(d[d.length-1]);return e}for(t=t.replace(/^\[(.+?)\]:\s*(.+)$/gm,(function(e,t,r){return f[t.toLowerCase()]=r,""})).replace(/^\n+|\n+$/g,"");s=c.exec(t);)o=t.substring(h,s.index),h=c.lastIndex,r=s[0],o.match(/[^\\](\\\\)*\\$/)||(s[3]||s[4]?r='<pre class="code '+(s[4]?"poetry":s[2].toLowerCase())+'">'+i(a(s[3]||s[4]).replace(/^\n+|\n+$/g,""))+"</pre>":s[6]?((l=s[6]).match(/\./)&&(s[5]=s[5].replace(/^\d+/gm,"")),u=e(i(s[5].replace(/^\s*[>*+.-]/gm,""))),">"===l?l="blockquote":(l=l.match(/\./)?"ol":"ul",u=u.replace(/^(.*)(\n|$)/gm,"<li>$1</li>")),r="<"+l+">"+u+"</"+l+">"):s[8]?r='<img src="'+a(s[8])+'" alt="'+a(s[7])+'">':s[10]?(p=p.replace("<a>",'<a href="'+a(s[11]||f[o.toLowerCase()])+'">'),r=y()+"</a>"):s[9]?r="<a>":s[12]||s[14]?r="<"+(l="h"+(s[14]?s[14].length:"="===s[13][0]?1:2))+">"+e(s[12]||s[15])+"</"+l+">":s[16]?r="<code>"+a(s[16])+"</code>":(s[17]||s[1])&&(r=m(s[17]||"--"))),p+=o,p+=r;return(p+t.substring(h)+y()).trim()};function u(e){return new Promise(t=>{setTimeout(t,e)})}function l(e,t,r={ignoreCase:!0}){return()=>Object(o.a)(this,void 0,void 0,(function*(){const o=document.querySelector(e);for(;o.value!==t&&(!r.ignoreCase||o.value.toLowerCase()!==t.toLowerCase());)yield u(100)}))}function c(e){return()=>Object(o.a)(this,void 0,void 0,(function*(){const t=document.querySelector(e);t||console.warn(`Could not find Element with selector "${e}"`),yield new Promise(e=>{t.addEventListener("click",()=>e())})}))}function d(e,t){return()=>Object(o.a)(this,void 0,void 0,(function*(){for(;;){const r=document.querySelector(e);if(r&&r.innerHTML===t)break;yield u(100)}}))}function p(e){return()=>u(e)}function h(e){return()=>Object(o.a)(this,void 0,void 0,(function*(){for(;window.location.hash!==`#/${e}`;)yield u(100)}))}const f={name:"Login Admin",hints:[{text:"To start this challenge, you'll have to log out first.",fixture:"#navbarAccount",unskippable:!0,resolved(){return Object(o.a)(this,void 0,void 0,(function*(){for(;null!==localStorage.getItem("token");)yield u(100)}))}},{text:"Let's try if we find a way to log in with the administrator's user account. To begin, go to the _Login_ page via the _Account_ menu.",fixture:"app-navbar",unskippable:!0,resolved:h("login")},{text:"To find a way around the normal login process we will try to use a **SQL Injection** (SQLi) attack.",fixture:"#email",resolved:p(8e3)},{text:"A good starting point for simple SQL Injections is to insert quotation marks (like `\"` or `'`). These mess with the syntax of an insecurely concatenated query and might give you feedback if an endpoint is vulnerable or not.",fixture:"#email",resolved:p(15e3)},{text:"Start with entering `'` in the **email field**.",fixture:"#email",unskippable:!0,resolved:l("#email","'")},{text:"Now put anything in the **password field**. It doesn't matter what.",fixture:"#password",unskippable:!0,resolved:function(e){return()=>Object(o.a)(this,void 0,void 0,(function*(){const e=document.querySelector("#password");for(;!e.value||""===e.value;)yield u(100)}))}()},{text:"Press the _Log in_ button.",fixture:"#rememberMe",unskippable:!0,resolved:c("#loginButton")},{text:"Nice! Do you see the red `[object Object]` error at the top? Unfortunately it isn't really telling us much about what went wrong...",fixture:"#rememberMe",resolved:p(1e4)},{text:"Maybe you will be able to find out more information about the error in the JavaScript console or the network tab of your browser!",fixture:"#rememberMe",resolved:p(1e4)},{text:"Did you spot the error message with the `SQLITE_ERROR` and the entire SQL query in the console output? If not, keep the console open and click _Log in_ again. Then inspect the occuring log message closely.",fixture:"#rememberMe",resolved:p(3e4)},{text:"Let's try to manipulate the query a bit to make it useful. Try out typing `' OR true` into the **email field**.",fixture:"#email",unskippable:!0,resolved:l("#email","' OR true")},{text:"Now click the _Log in_ button again.",fixture:"#rememberMe",unskippable:!0,resolved:c("#loginButton")},{text:"Mhh... The query is still invalid? Can you see why from the new error in the console?",fixture:"#rememberMe",resolved:p(8e3)},{text:"We need to make sure that the rest of the query after our injection doesn't get executed. Any Ideas?",fixture:"#rememberMe",resolved:p(8e3)},{text:"You can comment out anything after your injection payload from query using comments in SQL. In SQLite databases you can use `--` for that.",fixture:"#rememberMe",resolved:p(1e4)},{text:"So, type in `' OR true--` into the email field.",fixture:"#email",unskippable:!0,resolved:l("#email","' OR true--")},{text:"Press the _Log in_ button again and sit back...",fixture:"#rememberMe",unskippable:!0,resolved:c("#loginButton")},{text:"That worked, right?! To see with whose account you just logged in, open the _Account_ menu.",fixture:"#navbarAccount",unskippable:!0,resolved:c("#navbarAccount")},{text:"\u{1f389} Congratulations! You have been logged in as the **administrator** of the shop! (If you want to understand why, try to reproduce what your `' OR true--` did _exactly_ to the query.)",fixture:"app-navbar",resolved:p(2e4)}]},m={name:"DOM XSS",hints:[{text:"For this challenge, we'll take a close look at the _Search_ field at the top of the screen.",fixture:"#searchQuery",unskippable:!0,resolved:p(8e3)},{text:"Let's start by searching for all products containing `owasp` in their name or description.",fixture:"#searchQuery",unskippable:!0,resolved:l("#searchQuery input","owasp")},{text:"Now hit enter.",fixture:"#searchQuery",unskippable:!0,resolved:d("#searchValue","owasp")},{text:"Nice! You should now see many cool OWASP-related products.",fixture:"#searchQuery",resolved:p(8e3)},{text:"You might have noticed, that your search term is displayed above the results?",fixture:"app-search-result",resolved:p(8e3)},{text:"What we will try now is a **Cross-Site Scripting (XSS)** attack, where we try to inject HTML or JavaScript code into the application.",fixture:"app-search-result",resolved:p(15e3)},{text:"Change your search value into `<h1>owasp` to see if we can inject HTML.",fixture:"#searchQuery",unskippable:!0,resolved:l("#searchQuery input","<h1>owasp")},{text:"Hit enter again.",fixture:"#searchQuery",unskippable:!0,resolved:d("#searchValue","<h1>owasp</h1>")},{text:"Hmm, this doesn't look normal, does it?",fixture:".noResult",resolved:p(8e3)},{text:"If you right-click on the search term and inspect that part of the page with your browser, you will see that our `h1`-tag was _actually_ embedded into the page and is not just shown as plain text!",fixture:".noResult",resolved:p(16e3)},{text:"Let's now try to inject JavaScript. Type `<script>alert(xss)<\/script>` into the search box now.",fixture:"#searchQuery",unskippable:!0,resolved:l("#searchQuery input","<script>alert(xss)<\/script>")},{text:"Hit enter again.",fixture:"#searchQuery",unskippable:!0,resolved:d("#searchValue","<script>alert(xss)<\/script>")},{text:"\u{1f614} This didn't work as we hoped. If you inspect the page, you should see the `script`-tag but it is not executed for some reason.",fixture:".noResult",resolved:p(1e4)},{text:'Luckily there are _many_ different XSS payloads we can try. Let\'s try this one next: <code>&lt;iframe src="javascript:alert(&#96;xss&#96;)"&gt;&lt;/iframe&gt;</code>.',fixture:"#searchQuery",unskippable:!0,resolved:l("#searchQuery input",'<iframe src="javascript:alert(`xss`)">')},{text:"Hit enter one more time. If an alert box appears, you must confirm it in order to close it.",fixture:"#searchQuery",unskippable:!0,resolved:d("#searchValue",'<iframe src="javascript:alert(`xss`)"></iframe>')},{text:"\u{1f389} Congratulations! You just successfully performed an XSS attack!",fixture:".noResult",resolved:p(8e3)},{text:"More precisely, this was a **DOM XSS** attack, because your payload was handled and improperly embedded into the page by the application frontend code without even sending it to the server.",fixture:".noResult",resolved:p(16e3)}]},y={name:"Score Board",hints:[{text:"This application is riddled with security vulnerabilities. Your progress exploiting these is tracked on a _Score Board_.",fixture:"app-navbar",unskippable:!0,resolved:p(1e4)},{text:"You won't find a link to it in the navigation or side bar, though. Finding the _Score Board_ is in itself actually one of the hacking challenges.",fixture:"app-navbar",resolved:p(12e3)},{text:"You could just start guessing the URL of the _Score Board_ or comb through the client-side JavaScript code for useful information.",fixture:"app-navbar",resolved:p(12e3)},{text:"You find the JavaScript code in the DevTools of your browser that will open with `F12`. Or you just start URL guessing. It's up to you!",fixture:"app-navbar",unskippable:!0,resolved:h("score-board")},{text:"\u{1f389} Congratulations! You found the _Score Board_! Good luck and happy hacking!",fixture:"app-score-board",resolved:p(6e4)}]};r.d(t,"hasInstructions",(function(){return b})),r.d(t,"startHackingInstructorFor",(function(){return w}));const x=[y,f,m];function g(e){const t=document.querySelector(e.fixture);if(!t)return null;const r=document.createElement("div");r.id="hacking-instructor",r.style.position="absolute",r.style.zIndex="20000",r.style.backgroundColor="rgba(50, 115, 220, 0.9)",r.style.maxWidth="400px",r.style.minWidth=e.text.length>100?"350px":"250px",r.style.padding="16px",r.style.borderRadius="8px",r.style.whiteSpace="initial",r.style.lineHeight="1.3",r.style.top="24px",!0!==e.unskippable&&(r.style.cursor="pointer"),r.style.fontSize="14px",r.style.display="flex",r.style.alignItems="center";const o=document.createElement("img");o.style.minWidth="64px",o.style.minHeight="64px",o.style.width="64px",o.style.height="64px",o.style.marginRight="8px",o.src="/assets/public/images/hackingInstructor.png";const n=document.createElement("span");n.style.flexGrow="2",n.innerHTML=s(e.text),r.appendChild(o),r.appendChild(n);const i=document.createElement("div");return i.style.position="relative",i.style.display="inline",i.appendChild(r),t.parentElement.insertBefore(i,t),i}function v(e){return new Promise(t=>{e.addEventListener("click",t)})}function b(e){return void 0!==x.find(({name:t})=>t===e)}function w(e){return Object(o.a)(this,void 0,void 0,(function*(){const t=x.find(({name:t})=>t===e);for(const e of t.hints){const t=g(e);if(!t){console.warn(`Could not find Element with fixture "${e.fixture}"`);continue}t.scrollIntoView();const r=[e.resolved()];!0!==e.unskippable&&r.push(v(t)),yield Promise.race(r),t.remove()}}))}}}]);